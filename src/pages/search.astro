---
import BaseLayout from '../layouts/BaseLayout.astro';
---

<BaseLayout title="Search" description="記事を検索">
  <h1 class="text-3xl font-bold text-gray-900 dark:text-gray-100 mb-8">
    Search
  </h1>

  <link href="/pagefind/pagefind-ui.css" rel="stylesheet" />
  <div id="search" class="min-h-[300px]"></div>

  <script is:inline src="/pagefind/pagefind-ui.js"></script>
  <script is:inline>
    function initPagefind() {
      var el = document.getElementById('search');
      if (!el) return;
      if (typeof window.PagefindUI === 'undefined') {
        el.innerHTML = '<p style="color: #6b7280;">検索機能はビルド後に利用できます。<code>npm run build</code> を実行してください。</p>';
        return;
      }
      el.innerHTML = '';
      new window.PagefindUI({
        element: '#search',
        showSubResults: true,
        showImages: false,
        translations: {
          placeholder: '記事を検索...',
          zero_results: '「[SEARCH_TERM]」に一致する記事はありません',
          many_results: '[COUNT]件の記事が見つかりました',
          filters_label: 'フィルター',
          clear_search: 'クリア',
        },
      });
    }

    initPagefind();
    document.addEventListener('astro:after-swap', initPagefind);
  </script>
</BaseLayout>
