---
import { tagUrl } from '../utils/tags';

interface Props {
  title: string;
  date: Date;
  description?: string;
  tags: string[];
  slug: string;
  source?: string;
}

const { title, date, description, tags, slug, source } = Astro.props;

const formattedDate = date.toLocaleDateString('ja-JP', {
  year: 'numeric',
  month: 'long',
  day: 'numeric',
});
---

<article class="group glass rounded-2xl p-5 sm:p-6 gradient-border hover:shadow-glow dark:hover:shadow-glow transition-all duration-300">
  <a href={`/posts/${slug}`} class="block">
    <div class="flex items-center gap-2.5 mb-3">
      <time datetime={date.toISOString()} class="text-sm font-mono text-gray-400 dark:text-gray-500">
        {formattedDate}
      </time>
      {source && (
        <span class:list={[
          'text-xs px-2 py-0.5 rounded-full font-medium',
          source === 'blogspot'
            ? 'bg-orange-100/80 dark:bg-orange-500/10 text-orange-600 dark:text-orange-400 border border-orange-200/50 dark:border-orange-500/20'
            : 'bg-gp-100/80 dark:bg-neon-sky/10 text-gp-700 dark:text-neon-sky border border-gp-200/50 dark:border-neon-sky/20',
        ]}>
          {source}
        </span>
      )}
    </div>

    <h2 class="text-lg font-bold text-gray-900 dark:text-white group-hover:gradient-text transition-all duration-300 mb-2">
      {title}
    </h2>

    {description && (
      <p class="text-sm text-gray-500 dark:text-gray-400 line-clamp-2 mb-4 leading-relaxed">
        {description}
      </p>
    )}
  </a>

  {tags.length > 0 && (
    <div class="flex flex-wrap gap-1.5">
      {tags.map(tag => (
        <a
          href={tagUrl(tag)}
          class="text-xs px-2.5 py-1 rounded-lg bg-gray-100/80 dark:bg-white/[0.04] text-gray-500 dark:text-gray-400 border border-gray-200/50 dark:border-white/[0.06] hover:text-gp-600 dark:hover:text-neon-sky hover:border-gp-300 dark:hover:border-neon-sky/30 transition-all duration-200"
        >
          #{tag}
        </a>
      ))}
    </div>
  )}
</article>
