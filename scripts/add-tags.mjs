import { readFileSync, writeFileSync, readdirSync } from 'fs';
import { join } from 'path';

const postsDir = join(import.meta.dirname, '..', 'src', 'content', 'posts');

// Tag mapping: filename pattern â†’ tags to assign
// Tags: ã‚µãƒ³ãƒ•ãƒ©ãƒ³ã‚·ã‚¹ã‚³, èµ·æ¥­, Goodpatch, ãƒ‡ã‚¶ã‚¤ãƒ³, åƒãæ–¹, æŒ¯ã‚Šè¿”ã‚Š, ã‚¤ãƒ™ãƒ³ãƒˆ, ã‚µãƒ¼ãƒ“ã‚¹, ã‚ªãƒ•ã‚£ã‚¹, äºº, è³‡é‡‘èª¿é”, æµ·å¤–å±•é–‹, ãƒ—ãƒ­ãƒ€ã‚¯ãƒˆ
const tagRules = [
  // === æ¸¡ç±³æº–å‚™æœŸï¼ˆ2010-12ã€œ2011-03ï¼‰ ===
  { file: '2010-12-16-ã‚·ãƒªã‚³ãƒ³ãƒãƒ¬ãƒ¼ã«è¡ŒããŸã„ã‚“ã‚„ãƒ¼', tags: ['ã‚µãƒ³ãƒ•ãƒ©ãƒ³ã‚·ã‚¹ã‚³', 'èµ·æ¥­'] },
  { file: '2011-01-24-ã‚·ãƒªã‚³ãƒ³ãƒãƒ¬ãƒ¼ã¸ã®é“', tags: ['ã‚µãƒ³ãƒ•ãƒ©ãƒ³ã‚·ã‚¹ã‚³'] },
  { file: '2011-01-26-åˆã‚ã¦ã®èˆªç©ºåˆ¸è³¼å…¥', tags: ['ã‚µãƒ³ãƒ•ãƒ©ãƒ³ã‚·ã‚¹ã‚³'] },
  { file: '2011-02-01-ãƒ¬ã‚¸ãƒ¥ãƒ¡ã®æŽ¨è–¦æ–‡', tags: ['ã‚µãƒ³ãƒ•ãƒ©ãƒ³ã‚·ã‚¹ã‚³'] },
  { file: '2011-02-06-è‹±èªžã‚’å‹‰å¼·ã—ãªãã‚ƒ', tags: ['ã‚µãƒ³ãƒ•ãƒ©ãƒ³ã‚·ã‚¹ã‚³'] },
  { file: '2011-02-09-ã“ã®ãƒ–ãƒ­ã‚°ã®ãƒ•ã‚¡ãƒ³ãƒšãƒ¼ã‚¸', tags: ['ã‚µãƒ³ãƒ•ãƒ©ãƒ³ã‚·ã‚¹ã‚³'] },
  { file: '2011-02-13-ãªãœã‚·ãƒªã‚³ãƒ³ãƒãƒ¬ãƒ¼ã«è¡ŒããŸã„ã®ã‹', tags: ['ã‚µãƒ³ãƒ•ãƒ©ãƒ³ã‚·ã‚¹ã‚³', 'èµ·æ¥­'] },
  { file: '2011-02-15-olympus-pen-lite', tags: ['ã‚µãƒ³ãƒ•ãƒ©ãƒ³ã‚·ã‚¹ã‚³'] },
  { file: '2011-02-17-appleã‚¹ãƒ†ã‚£ãƒ¼ãƒ–', tags: ['ã‚µãƒ³ãƒ•ãƒ©ãƒ³ã‚·ã‚¹ã‚³'] },
  { file: '2011-02-20-ã‚¸ãƒ§ãƒ–ã‚ºãŒå…ƒæ°—ãªå§¿ã‚’', tags: ['ã‚µãƒ³ãƒ•ãƒ©ãƒ³ã‚·ã‚¹ã‚³'] },
  { file: '2011-02-23-è‹±èªžæ•™å®¤ã«é€šã„ã ã—ã¾ã—ãŸ', tags: ['ã‚µãƒ³ãƒ•ãƒ©ãƒ³ã‚·ã‚¹ã‚³'] },
  { file: '2011-03-01-ãŠå®¢ã•ã‚“ã‹ã‚‰ã®ã‚¢ãƒ‰ãƒã‚¤ã‚¹', tags: ['ã‚µãƒ³ãƒ•ãƒ©ãƒ³ã‚·ã‚¹ã‚³'] },
  { file: '2011-03-05-ã‚·ãƒªã‚³ãƒ³ãƒãƒ¬ãƒ¼ã‚«ãƒ³ãƒ•ã‚¡ãƒ¬ãƒ³ã‚¹2011ã¾ã§', tags: ['ã‚µãƒ³ãƒ•ãƒ©ãƒ³ã‚·ã‚¹ã‚³', 'ã‚¤ãƒ™ãƒ³ãƒˆ'] },
  { file: '2011-03-09-æ¸¡ç±³å‰æ—¥', tags: ['ã‚µãƒ³ãƒ•ãƒ©ãƒ³ã‚·ã‚¹ã‚³'] },
  { file: '2011-03-14-ã‚·ãƒªã‚³ãƒ³ãƒãƒ¬ãƒ¼ã«ã„ã¦åƒ•ã‚‰ã«ã§ãã‚‹ã“ã¨', tags: ['ã‚µãƒ³ãƒ•ãƒ©ãƒ³ã‚·ã‚¹ã‚³'] },

  // === SFæ”¾æµªè¨˜ãƒ»ä¼æ¥­è¨ªå•ï¼ˆ2011-03ã€œ04ï¼‰ ===
  { file: '2011-03-17-ã‚·ãƒªã‚³ãƒ³ãƒãƒ¬ãƒ¼æ”¾æµªè¨˜ã‚µãƒ³ãƒ•ãƒ©ãƒ³ã‚·ã‚¹ã‚³åˆæ—¥', tags: ['ã‚µãƒ³ãƒ•ãƒ©ãƒ³ã‚·ã‚¹ã‚³'] },
  { file: '2011-03-20-ã‚·ãƒªã‚³ãƒ³ãƒãƒ¬ãƒ¼æ”¾æµªè¨˜2', tags: ['ã‚µãƒ³ãƒ•ãƒ©ãƒ³ã‚·ã‚¹ã‚³', 'ã‚¤ãƒ™ãƒ³ãƒˆ'] },
  { file: '2011-03-24-ã‚·ãƒªã‚³ãƒ³ãƒãƒ¬ãƒ¼æ”¾æµªè¨˜3', tags: ['ã‚µãƒ³ãƒ•ãƒ©ãƒ³ã‚·ã‚¹ã‚³', 'ã‚¤ãƒ™ãƒ³ãƒˆ'] },
  { file: '2011-03-31-ã‚·ãƒªã‚³ãƒ³ãƒãƒ¬ãƒ¼æ”¾æµªè¨˜4google', tags: ['ã‚µãƒ³ãƒ•ãƒ©ãƒ³ã‚·ã‚¹ã‚³'] },
  { file: '2011-03-31-ã‚·ãƒªã‚³ãƒ³ãƒãƒ¬ãƒ¼æ”¾æµªè¨˜5facebook', tags: ['ã‚µãƒ³ãƒ•ãƒ©ãƒ³ã‚·ã‚¹ã‚³'] },

  // === SFç”Ÿæ´»ãƒ»ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ³æœŸï¼ˆ2011-04ã€œ07ï¼‰ ===
  { file: '2011-04-02-ã‚µãƒ³ãƒ•ãƒ©ãƒ³ã‚·ã‚¹ã‚³ã«æ—…ç«‹ã¡ã¾ã™', tags: ['ã‚µãƒ³ãƒ•ãƒ©ãƒ³ã‚·ã‚¹ã‚³', 'åƒãæ–¹'] },
  { file: '2011-04-05-ã‚µãƒ³ãƒ•ãƒ©ãƒ³ã‚·ã‚¹ã‚³ã§åˆå‡ºå‹¤', tags: ['ã‚µãƒ³ãƒ•ãƒ©ãƒ³ã‚·ã‚¹ã‚³', 'åƒãæ–¹'] },
  { file: '2011-04-12-ã‚µãƒ³ãƒ•ãƒ©ãƒ³ã‚·ã‚¹ã‚³ã®å®¶æŽ¢ã—', tags: ['ã‚µãƒ³ãƒ•ãƒ©ãƒ³ã‚·ã‚¹ã‚³'] },
  { file: '2011-04-13-è‰²ã‚“ãªäººã«ã‚µãƒ³ãƒ•ãƒ©ãƒ³ã‚·ã‚¹ã‚³ã§å‡ºä¼šã£ãŸ', tags: ['ã‚µãƒ³ãƒ•ãƒ©ãƒ³ã‚·ã‚¹ã‚³', 'äºº'] },
  { file: '2011-04-22-ã‚µãƒ³ãƒ•ãƒ©ãƒ³ã‚·ã‚¹ã‚³åŽ³é‡è­¦æˆ’', tags: ['ã‚µãƒ³ãƒ•ãƒ©ãƒ³ã‚·ã‚¹ã‚³'] },
  { file: '2011-04-25-èµ·æ¥­å®¶ã«ã¨ã£ã¦ã®ç†æƒ³ã®ã‚ªãƒ•ã‚£ã‚¹', tags: ['ã‚µãƒ³ãƒ•ãƒ©ãƒ³ã‚·ã‚¹ã‚³', 'ã‚ªãƒ•ã‚£ã‚¹'] },
  { file: '2011-05-02-ã‚µãƒ³ãƒ•ãƒ©ãƒ³ã‚·ã‚¹ã‚³ã§ä¸€ãƒ¶æœˆåƒã„ã¦', tags: ['ã‚µãƒ³ãƒ•ãƒ©ãƒ³ã‚·ã‚¹ã‚³', 'åƒãæ–¹'] },
  { file: '2011-05-05-ã‚µãƒ³ãƒ•ãƒ©ãƒ³ã‚·ã‚¹ã‚³ã§ä¸€ãƒ¶æœˆç”Ÿæ´»ã—ã¦', tags: ['ã‚µãƒ³ãƒ•ãƒ©ãƒ³ã‚·ã‚¹ã‚³'] },
  { file: '2011-05-11-ã‚«ãƒ¼ã‚·ã‚§ã‚¢ãƒªãƒ³ã‚°ã‚µãƒ¼ãƒ“ã‚¹zipcar', tags: ['ã‚µãƒ³ãƒ•ãƒ©ãƒ³ã‚·ã‚¹ã‚³', 'ã‚µãƒ¼ãƒ“ã‚¹'] },
  { file: '2011-05-16-ã¡ã‚‡ã£ã¨ãƒªãƒƒãƒãªãƒã‚¤ãƒ¤ãƒ¼ã‚µãƒ¼ãƒ“ã‚¹uber', tags: ['ã‚µãƒ³ãƒ•ãƒ©ãƒ³ã‚·ã‚¹ã‚³', 'ã‚µãƒ¼ãƒ“ã‚¹'] },
  { file: '2011-05-18-ã‚µãƒ³ãƒ•ãƒ©ãƒ³ã‚·ã‚¹ã‚³ç”Ÿæ´»ã‚‚åŠåˆ†', tags: ['ã‚µãƒ³ãƒ•ãƒ©ãƒ³ã‚·ã‚¹ã‚³'] },
  { file: '2011-05-19-ä¸–ç•Œä¸€å‘¨ã®æ—…ã«å‡ºã‚‹æˆç€¬ãã‚“', tags: ['ã‚µãƒ³ãƒ•ãƒ©ãƒ³ã‚·ã‚¹ã‚³', 'äºº'] },
  { file: '2011-05-22-ã‚·ãƒªã‚³ãƒ³ãƒãƒ¬ãƒ¼ã§æœ€ã‚‚è¡Œåˆ—ãŒã§ãã‚‹ãƒ©ãƒ¼ãƒ¡ãƒ³', tags: ['ã‚µãƒ³ãƒ•ãƒ©ãƒ³ã‚·ã‚¹ã‚³'] },
  { file: '2011-05-26-denaå—å ´ç¤¾é•·ãŒé€€ä»»', tags: ['èµ·æ¥­'] },
  { file: '2011-05-28-japannightã¾ã§ã‚ã¨ä¸€ãƒ¶æœˆ', tags: ['ã‚µãƒ³ãƒ•ãƒ©ãƒ³ã‚·ã‚¹ã‚³', 'ã‚¤ãƒ™ãƒ³ãƒˆ'] },
  { file: '2011-06-02-ã¾ã•ã‹ã‚µãƒ³ãƒ•ãƒ©ãƒ³ã‚·ã‚¹ã‚³ã§çŸ¢æ²¢æ°¸å‰', tags: ['ã‚µãƒ³ãƒ•ãƒ©ãƒ³ã‚·ã‚¹ã‚³'] },
  { file: '2011-06-11-ãƒ¡ã‚¸ãƒ£ãƒ¼ãƒªãƒ¼ã‚°att-park', tags: ['ã‚µãƒ³ãƒ•ãƒ©ãƒ³ã‚·ã‚¹ã‚³'] },
  { file: '2011-06-17-ã‚µãƒ³ãƒ•ãƒ©ãƒ³ã‚·ã‚¹ã‚³ç”Ÿæ´»ã‚‚ã‚ã¨2é€±é–“', tags: ['ã‚µãƒ³ãƒ•ãƒ©ãƒ³ã‚·ã‚¹ã‚³'] },
  { file: '2011-06-20-ãªãœæ—¥æœ¬ã®itæ¥­ç•Œã®ãƒ—ãƒ¬ã‚¼ãƒ³ã‚¹ãŒä½Žã„', tags: ['ã‚µãƒ³ãƒ•ãƒ©ãƒ³ã‚·ã‚¹ã‚³', 'èµ·æ¥­'] },
  { file: '2011-06-24-ãƒ–ãƒ­ã‚°ã®ãƒ‘ãƒ¯ãƒ¼', tags: ['ã‚µãƒ³ãƒ•ãƒ©ãƒ³ã‚·ã‚¹ã‚³'] },
  { file: '2011-06-27-å‹¢ã„ã®ã‚ã‚‹äººã®å…ƒã§åƒã', tags: ['ã‚µãƒ³ãƒ•ãƒ©ãƒ³ã‚·ã‚¹ã‚³', 'åƒãæ–¹', 'äºº'] },
  { file: '2011-06-29-ç¬¬2å›žjapannight', tags: ['ã‚µãƒ³ãƒ•ãƒ©ãƒ³ã‚·ã‚¹ã‚³', 'ã‚¤ãƒ™ãƒ³ãƒˆ'] },
  { file: '2011-06-30-3ãƒ¶æœˆé–“ã®ã‚µãƒ³ãƒ•ãƒ©ãƒ³ã‚·ã‚¹ã‚³ç”Ÿæ´»ã‚’æŒ¯ã‚Šè¿”ã‚Š', tags: ['ã‚µãƒ³ãƒ•ãƒ©ãƒ³ã‚·ã‚¹ã‚³', 'æŒ¯ã‚Šè¿”ã‚Š'] },

  // === èµ·æ¥­æº–å‚™ãƒ»Goodpatchå‰µæ¥­ï¼ˆ2011-07ã€œ09ï¼‰ ===
  { file: '2011-07-07-äººã®ç¸ã¨ã¯ä¸æ€è­°ãªã‚‚ã®', tags: ['äºº'] },
  { file: '2011-07-12-ä¼šç¤¾åãŒæ±ºã¾ã‚Šã¾ã—ãŸ', tags: ['èµ·æ¥­', 'Goodpatch'] },
  { file: '2011-08-04-ãƒ­ã‚´ã¨äº‹æ¥­ã¨å‰µæ¥­ãƒ¡ãƒ³ãƒãƒ¼', tags: ['èµ·æ¥­', 'Goodpatch'] },
  { file: '2011-08-20-goodpatchè¨­ç«‹ãƒ‘ãƒ¼ãƒ†ã‚£ãƒ¼', tags: ['èµ·æ¥­', 'Goodpatch', 'ã‚¤ãƒ™ãƒ³ãƒˆ'] },
  { file: '2011-08-28-btraxã§ecstudio', tags: ['ã‚µãƒ³ãƒ•ãƒ©ãƒ³ã‚·ã‚¹ã‚³', 'äºº'] },
  { file: '2011-09-01-goodpatchæ³•äººç™»è¨˜å®Œäº†', tags: ['èµ·æ¥­', 'Goodpatch'] },
  { file: '2011-09-07-æ˜Žæ—¥ã‹ã‚‰2ãƒ¶æœˆã¶ã‚Šã®ã‚µãƒ³ãƒ•ãƒ©ãƒ³ã‚·ã‚¹ã‚³ã¸', tags: ['ã‚µãƒ³ãƒ•ãƒ©ãƒ³ã‚·ã‚¹ã‚³'] },
  { file: '2011-09-13-ã‚°ãƒ­ãƒ¼ãƒãƒ«ã«ç¹‹ãŒã‚‹co-working-space', tags: ['ã‚µãƒ³ãƒ•ãƒ©ãƒ³ã‚·ã‚¹ã‚³', 'ã‚ªãƒ•ã‚£ã‚¹'] },
  { file: '2011-09-21-san-franciscoã®ãã®ä»–co-working-space', tags: ['ã‚µãƒ³ãƒ•ãƒ©ãƒ³ã‚·ã‚¹ã‚³', 'ã‚ªãƒ•ã‚£ã‚¹'] },
  { file: '2011-10-02-japannightæœ€çµ‚äºˆé¸', tags: ['ã‚¤ãƒ™ãƒ³ãƒˆ'] },
  { file: '2011-11-22-è¿‘æ³å ±å‘Šã¨hub-tokyo', tags: ['èµ·æ¥­', 'ã‚ªãƒ•ã‚£ã‚¹'] },
  { file: '2011-12-31-2011å¹´ã‚’æŒ¯ã‚Šè¿”ã‚Š', tags: ['æŒ¯ã‚Šè¿”ã‚Š'] },

  // === GoodpatchåˆæœŸï¼ˆ2012ï¼‰ ===
  { file: '2012-03-01-èµ·æ¥­ã—ã¦6ãƒ¶æœˆçµŒã¡ã¾ã—ãŸ', tags: ['èµ·æ¥­', 'Goodpatch', 'æŒ¯ã‚Šè¿”ã‚Š'] },
  { file: '2012-03-10-ã¡ã‚‡ã†ã©ä¸€å¹´å‰', tags: ['ã‚µãƒ³ãƒ•ãƒ©ãƒ³ã‚·ã‚¹ã‚³', 'æŒ¯ã‚Šè¿”ã‚Š'] },
  { file: '2012-03-19-etsyã§mac-book-air', tags: ['ã‚µãƒ¼ãƒ“ã‚¹'] },
  { file: '2012-03-28-ç¬¬4å›žsf-new-tech-japannight', tags: ['ã‚¤ãƒ™ãƒ³ãƒˆ'] },
  { file: '2012-05-15-startup-weekend-tokyo', tags: ['èµ·æ¥­', 'ã‚¤ãƒ™ãƒ³ãƒˆ'] },
  { file: '2012-07-08-gunosyã¨ã„ã†ã‚µãƒ¼ãƒ“ã‚¹ã«é–¢ã‚ã£ã¦', tags: ['èµ·æ¥­', 'ãƒ—ãƒ­ãƒ€ã‚¯ãƒˆ'] },
  { file: '2012-09-03-èµ·æ¥­ã—ã¦ä¸€å¹´ãŒçµŒã¡ã¾ã—ãŸ', tags: ['èµ·æ¥­', 'Goodpatch', 'æŒ¯ã‚Šè¿”ã‚Š'] },
  { file: '2012-09-05-ãƒ–ãƒ­ã‚°ç§»è»¢ã—ã¾ã—ãŸ', tags: [] },
  { file: '2012-09-08-åŠªåŠ›ã—ãŸã‚‚ã®ãŒã™ã¹ã¦æˆåŠŸã™ã‚‹', tags: ['èµ·æ¥­'] },
  { file: '2012-11-12-ã‚°ãƒƒãƒ‰ãƒ‘ãƒƒãƒã®äººæå‹Ÿé›†', tags: ['Goodpatch', 'äºº'] },
  { file: '2012-12-31-2012å¹´ã«çµŒå–¶è€…ã¨ã—ã¦', tags: ['èµ·æ¥­', 'Goodpatch', 'æŒ¯ã‚Šè¿”ã‚Š'] },

  // === Goodpatchæˆé•·æœŸï¼ˆ2013ï¼‰ ===
  { file: '2013-02-03-10åªã®ç§‹è‘‰åŽŸã®ã‚ªãƒ•ã‚£ã‚¹', tags: ['Goodpatch', 'ã‚ªãƒ•ã‚£ã‚¹'] },
  { file: '2013-03-05-äººæã®å¼•ããŒå‡„ã„ä»¶', tags: ['Goodpatch', 'äºº'] },
  { file: '2013-03-10-å®®å´Žã¨ç¦å²¡ã¨ã‚·ãƒªã‚³ãƒ³ãƒãƒ¬ãƒ¼ã¨', tags: ['ã‚µãƒ³ãƒ•ãƒ©ãƒ³ã‚·ã‚¹ã‚³'] },
  { file: '2013-04-01-ã‚ã‚Œã‹ã‚‰1å¹´ãŒçµŒã¡', tags: ['Goodpatch', 'æŒ¯ã‚Šè¿”ã‚Š'] },
  { file: '2013-06-15-denaå—å ´ã•ã‚“', tags: ['èµ·æ¥­'] },
  { file: '2013-06-16-èµ·æ¥­ã«è¸ã¿ãã‚ŒãŸã‚­ãƒƒã‚«ã‚±', tags: ['èµ·æ¥­'] },
  { file: '2013-08-28-4å¹´è¶Šã—ã§', tags: ['æŒ¯ã‚Šè¿”ã‚Š'] },
  { file: '2013-09-08-èµ·æ¥­ã—ã¦äºŒå¹´ãŒçµŒã¡ã¾ã—ãŸ', tags: ['èµ·æ¥­', 'Goodpatch', 'æŒ¯ã‚Šè¿”ã‚Š'] },
  { file: '2013-11-02-ã˜ã„ã¡ã‚ƒã‚“ã®è‘¬å„€', tags: [] },
  { file: '2013-12-09-1å„„å††ã®è³‡é‡‘èª¿é”', tags: ['Goodpatch', 'è³‡é‡‘èª¿é”'] },
  { file: '2013-12-15-ã“ã®ãƒ–ãƒ­ã‚°ã‚’ã¯ã˜ã‚ã¦ä¸¸3å¹´', tags: ['æŒ¯ã‚Šè¿”ã‚Š'] },
  { file: '2013-12-28-ç¤¾å“¡ã‚’é€£ã‚Œã¦ã‚·ãƒªã‚³ãƒ³ãƒãƒ¬ãƒ¼', tags: ['ã‚µãƒ³ãƒ•ãƒ©ãƒ³ã‚·ã‚¹ã‚³', 'Goodpatch'] },

  // === Goodpatchæ‹¡å¤§æœŸï¼ˆ2014-2015ï¼‰ ===
  { file: '2014-02-23-ã‚°ãƒƒãƒ‰ãƒ‘ãƒƒãƒãŒã‚¹ã‚¿ãƒ¼ãƒˆã‚¢ãƒƒãƒ—ã®ä»•äº‹ã‚’å—ã‘ã‚‹', tags: ['Goodpatch', 'ãƒ‡ã‚¶ã‚¤ãƒ³'] },
  { file: '2014-06-20-æ¸‹è°·ã«ç§»è»¢ã—ãŸã®ã§', tags: ['Goodpatch', 'ã‚ªãƒ•ã‚£ã‚¹'] },
  { file: '2014-06-29-æœªçµŒé¨“è€…ã‹ã‚‰å…¥ã£ãŸã‚¹ã‚¿ãƒƒãƒ•', tags: ['Goodpatch', 'äºº'] },
  { file: '2014-07-06-ã¿ã‚“ãªã§10å¹´å¾Œã®ã‚°ãƒƒãƒ‰ãƒ‘ãƒƒãƒ', tags: ['Goodpatch'] },
  { file: '2014-11-17-ã‚°ãƒƒãƒ‰ãƒ‘ãƒƒãƒã«ãƒ‡ã‚¶ã‚¤ãƒŠãƒ¼ãŒé›†ã¾ã‚‹', tags: ['Goodpatch', 'ãƒ‡ã‚¶ã‚¤ãƒ³', 'äºº'] },
  { file: '2014-12-30-2014å¹´ã®æŒ¯ã‚Šè¿”ã‚Š', tags: ['æŒ¯ã‚Šè¿”ã‚Š'] },
  { file: '2015-02-01-ã‚°ãƒƒãƒ‰ãƒ‘ãƒƒãƒç¬¬1å·ç¤¾å“¡ã®å’æ¥­', tags: ['Goodpatch', 'äºº'] },
  { file: '2015-04-05-uiã«äº‹æ¥­ã‚’çµžã£ã¦ã‹ã‚‰3å¹´', tags: ['Goodpatch', 'ãƒ‡ã‚¶ã‚¤ãƒ³', 'æŒ¯ã‚Šè¿”ã‚Š'] },
  { file: '2015-05-17-ãƒ™ãƒ«ãƒªãƒ³ã«ã‚ªãƒ•ã‚£ã‚¹ã‚’å‡ºã—ãŸç†ç”±', tags: ['Goodpatch', 'æµ·å¤–å±•é–‹'] },
  { file: '2015-06-21-å®¶æ—ãŒã„ã‚‹èµ·æ¥­å®¶ã®åƒãæ–¹', tags: ['èµ·æ¥­', 'åƒãæ–¹'] },
  { file: '2015-11-15-monodukuri', tags: ['Goodpatch', 'ãƒ‡ã‚¶ã‚¤ãƒ³'] },
  { file: '2015-12-31-2015å¹´ã‚’æŒ¯ã‚Šè¿”ã‚‹', tags: ['æŒ¯ã‚Šè¿”ã‚Š'] },

  // === çµ„ç¹”æ‹¡å¤§æœŸï¼ˆ2016-2019ï¼‰ ===
  { file: '2016-02-03-ã‚­ãƒƒãƒãƒ³ã®ã‚ã‚‹ã‚ªãƒ•ã‚£ã‚¹', tags: ['Goodpatch', 'ã‚ªãƒ•ã‚£ã‚¹'] },
  { file: '2016-06-26-ç¤¾é•·ã®æ†‚é¬±', tags: ['èµ·æ¥­', 'Goodpatch'] },
  { file: '2016-12-31-2016å¹´ã‚’æŒ¯ã‚Šè¿”ã‚‹', tags: ['æŒ¯ã‚Šè¿”ã‚Š'] },
  { file: '2017-01-26-balto', tags: ['Goodpatch', 'ãƒ—ãƒ­ãƒ€ã‚¯ãƒˆ'] },
  { file: '2019-12-29-noteã§ãƒ–ãƒ­ã‚°ã¯æ›´æ–°ã‚’ç¶šã‘ã¦ã¾ã™', tags: [] },
];

let updated = 0;
let skipped = 0;

const files = readdirSync(postsDir).filter(f => f.endsWith('.md'));

for (const rule of tagRules) {
  if (rule.tags.length === 0) continue;

  const matchingFile = files.find(f => f.includes(rule.file));
  if (!matchingFile) {
    console.log(`âš ï¸  No file found for: ${rule.file}`);
    continue;
  }

  const filePath = join(postsDir, matchingFile);
  let content = readFileSync(filePath, 'utf-8');

  // Check if it already has tags (non-empty)
  const tagsMatch = content.match(/^tags:\s*\[(.*?)\]/m);
  if (tagsMatch && tagsMatch[1].trim() !== '') {
    // Already has tags - merge with new ones
    const existingTags = tagsMatch[1].split(',').map(t => t.trim().replace(/['"]/g, '')).filter(Boolean);
    const allTags = [...new Set([...existingTags, ...rule.tags])];
    const newTagLine = `tags: [${allTags.map(t => `'${t}'`).join(', ')}]`;
    content = content.replace(/^tags:\s*\[.*?\]/m, newTagLine);
  } else if (tagsMatch) {
    // Empty tags array - replace
    const newTagLine = `tags: [${rule.tags.map(t => `'${t}'`).join(', ')}]`;
    content = content.replace(/^tags:\s*\[\s*\]/m, newTagLine);
  }

  writeFileSync(filePath, content, 'utf-8');
  updated++;
}

console.log(`\nâœ… Updated ${updated} files`);
console.log(`â­ï¸  Skipped ${skipped} files`);

// Print tag summary
const tagCount = new Map();
for (const rule of tagRules) {
  for (const tag of rule.tags) {
    tagCount.set(tag, (tagCount.get(tag) || 0) + 1);
  }
}
console.log('\nðŸ“Š Tag distribution:');
[...tagCount.entries()].sort((a, b) => b[1] - a[1]).forEach(([tag, count]) => {
  console.log(`   ${tag}: ${count} posts`);
});
